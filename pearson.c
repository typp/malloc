/*
** pearson.c for Malloc in /home/la-val_c/rendu/PSU_2013_malloc
**
** Made by Cyril La Valle
** Login <la-val_c@epitech.eu>
**
** Started on  Mon Feb  9 10:51:01 2015 Cyril La Valle
** Last update Sun Feb 15 22:08:43 2015 Zadkiel Aslafy-Aharonian
*/

#include <stdint.h>

static const uint8_t permutation_table[256] =
{
  169,  73, 54,   56, 234, 152, 4,   111, 183,  45, 218,  15, 229,  23,
  32,  161, 62,   48, 21,  115, 131,  83, 187,  38, 27,  238, 18,  165,
  102, 197, 78,  175, 251, 135, 153, 147, 139,   8, 74,  184, 227,  89,
  158, 250, 121,  63, 67,   43, 242, 172, 230,  24, 199, 212, 108,  58,
  240, 233, 236,  66, 130, 127, 205, 202, 133, 110, 35,  104, 157,  98,
  171,  84, 209, 196, 176, 101, 220, 120, 57,    7, 228, 248, 159,  92,
  225, 223, 99,  174, 106,  52, 216,  81, 87,   64, 186, 235, 194,  79,
  160,  39, 44,   97, 51,  253, 156,  49, 126,  16, 122,  96, 82,  241,
  146, 114, 125,  34, 109,  77, 14,   11, 65,  192, 231,  90, 252, 203,
  224, 204, 245,  93, 210, 217, 221, 255, 61,   36, 33,  123, 86,  201,
  50,  206, 6,   193, 0,   170, 208, 185, 26,   30, 91,  162, 254, 179,
  140,  17, 20,   28, 144, 244, 213, 243, 85,  136, 118,  69, 119,  53,
  154, 103, 155, 128, 141,  75, 143, 129, 207,  10, 211, 112, 72,  124,
  148,   9, 132, 188, 71,   95, 219, 107, 214,  88, 198, 167, 173, 239,
  19,   76, 178, 164, 70,   25, 105, 113, 31,  177, 68,   60, 226,   1,
  134, 190, 222, 100, 246, 168, 5,   180, 215, 151, 232, 166, 249,  42,
  47,  237, 12,  195, 138,   2, 59,  163, 145,  55, 137, 150, 149,  37,
  46,   29, 116, 200, 22,   13, 142,  40,  94, 117,  41, 191, 3,   247,
  181, 189, 80,  182
};

/*
** NOTE: we could make this faster by check with wider types (int by int
** rather than char by char)
*/
uint8_t		pearson(const uint8_t *mem, uint8_t size)
{
  uint8_t	hash;

  hash = 0;
  while (size)
    {
      --size;
      hash = permutation_table[hash ^ mem[size]];
    }
  return (hash);
}
